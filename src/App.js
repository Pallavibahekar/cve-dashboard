import React, { useEffect, useState } from 'react';
import { fetchCveData } from './api/cveService';
import VulnerabilityTable from './components/VulnerabilityTable';
import Overview from './pages/Overview';

const App = () => {
  const [data, setData] = useState([]);

  useEffect(() => {
    const loadData = async () => {
      try {
        const result = await fetchCveData();
        setData(result.vulnerabilities);
      } catch (error) {
        console.error('Error loading CVE data', error);
      }
    };
    loadData();
  }, []);

  const handleSearch = (query) => {
    const filteredData = data.filter(item =>
      item.cve_id.toLowerCase().includes(query.toLowerCase())
    );
    setData(filteredData);
  };

  return (
    <div>
      <h1>CVE Dashboard</h1>
      <Overview onSearch={handleSearch} />
      <VulnerabilityTable data={data} />
    </div>
  );
};

export default App;
